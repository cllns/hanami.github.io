<!doctype html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lotus - Guides - Form Helpers</title>
    <meta name="description" content="Lotus, a complete web framework for Ruby" />
    <meta name="keywords" content="lotus,web,framework,ruby,open source,oss,os,software,free,free software,architecture,fast,lightweight,testing,tdd,bdd,test driven development,behaviour driven development,full stack,mvc,model view object,pattern,patterns,design patterns,oop,object oriented programming,testability,http,https,routing,router,http router,restful,resource,resources,convention,controller,models,repository,query,sql,interactors,two-step view,view,template,presenters,render,rendering,helpers,erb,haml,tilt,json,xml,yaml,yml,framwork,framewrok,riby,free sowftare"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="http://feeds.feedburner.com/lotusrb" rel="alternate" title="Lotus" type="application/atom+xml" />

    <link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />

    <script src="//use.typekit.net/xhp5wmc.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>
  </head>
  <body class="subpage docs">
    <!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<nav class="navbar navbar-fixed-top container-fluid">
  <div class="wrapper container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Logo</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="/guides">Guides</a></li>
        <li><a href="/community">Community</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="https://rubygems.org/gems/lotusrb" id="nav-link-install" target="_blank" class="btn btn-primary version">Install v0.5.0</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>


    <section class="docs wrapper animated fadeIn">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-3 hidden-sm hidden-xs sidebar">
            <ul class="nav nav-sidebar">
              <li>
                <span class="heading">Getting Started</span>
                <ul class="nav">
                  <li><a href="/guides/getting-started">Getting Started</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Architectures</span>
                <ul class="nav">
                  <li><a href="/guides/architectures/overview">Overview</a></li>
                  <li><a href="/guides/architectures/container">Container</a></li>
                  <li><a href="/guides/architectures/application">Application</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Routing</span>
                <ul class="nav">
                  <li><a href="/guides/routing/overview">Overview</a></li>
                  <li><a href="/guides/routing/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/routing/restful-resources">RESTful Resource(s)</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Actions</span>
                <ul class="nav">
                  <li><a href="/guides/actions/overview">Overview</a></li>
                  <li><a href="/guides/actions/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/actions/parameters">Parameters</a></li>
                  <li><a href="/guides/actions/request-and-response">Request & Response</a></li>
                  <li><a href="/guides/actions/exposures">Exposures</a></li>
                  <li><a href="/guides/actions/rack-integration">Rack Integration</a></li>
                  <li><a href="/guides/actions/mime-types">MIME Types</a></li>
                  <li><a href="/guides/actions/cookies">Cookies</a></li>
                  <li><a href="/guides/actions/sessions">Sessions</a></li>
                  <li><a href="/guides/actions/exception-handling">Exception Handling</a></li>
                  <li><a href="/guides/actions/control-flow">Control Flow</a></li>
                  <li><a href="/guides/actions/http-caching">HTTP Caching</a></li>
                  <li><a href="/guides/actions/share-code">Share Code</a></li>
                  <li><a href="/guides/actions/testing">Testing</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Views</span>
                <ul class="nav">
                  <li><a href="/guides/views/overview">Overview</a></li>
                  <li><a href="/guides/views/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/views/templates">Templates</a></li>
                  <li><a href="/guides/views/mime-types">MIME Types</a></li>
                  <li><a href="/guides/views/layouts">Layouts</a></li>
                  <li><a href="/guides/views/custom-error-pages">Custom Error Pages</a></li>
                  <li><a href="/guides/views/share-code">Share Code</a></li>
                  <li><a href="/guides/views/testing">Testing</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Models</span>
                <ul class="nav">
                  <li><a href="/guides/models/overview">Overview</a></li>
                  <li><a href="/guides/models/entities">Entities</a></li>
                  <li><a href="/guides/models/repositories">Repositories</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Migrations</span>
                <ul class="nav">
                  <li><a href="/guides/migrations/overview">Overview</a></li>
                  <li><a href="/guides/migrations/create-table">Create Table</a></li>
                  <li><a href="/guides/migrations/alter-table">Alter Table</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Helpers</span>
                <ul class="nav">
                  <li><a href="/guides/helpers/overview">Overview</a></li>
                  <li><a href="/guides/helpers/html5">HTML5</a></li>
                  <li><a href="/guides/helpers/forms">Forms</a></li>
                  <li><a href="/guides/helpers/routing">Routing</a></li>
                  <li><a href="/guides/helpers/links">Links</a></li>
                  <li><a href="/guides/helpers/escape">Markup Escape</a></li>
                  <li><a href="/guides/helpers/numbers">Numbers</a></li>
                  <li><a href="/guides/helpers/custom-helpers">Custom Helpers</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Mailers</span>
                <ul class="nav">
                  <li><a href="/guides/mailers/overview">Overview</a></li>
                  <li><a href="/guides/mailers/basic-usage">Basic Usage</a></li>
                  <li><a href="/guides/mailers/templates">Templates</a></li>
                  <li><a href="/guides/mailers/delivery">Delivery</a></li>
                  <li><a href="/guides/mailers/share-code">Share Code</a></li>
                  <li><a href="/guides/mailers/testing">Testing</a></li>
                </ul>
              </li>

              <li>
                <span class="heading">Command Line</span>
                <ul class="nav">
                  <li><a href="/guides/command-line/applications">Applications</a></li>
                  <li><a href="/guides/command-line/generators">Generators</a></li>
                  <li><a href="/guides/command-line/database">Database</a></li>
                  <li><a href="/guides/command-line/routes">Routes</a></li>
                  <li><a href="/guides/command-line/version">Version</a></li>
                </ul>
              </li>
            </ul>

          </div>

          <div class="col-md-9 main">
            <div class="doc-section">
              <a href="https://github.com/lotus/lotus.github.io/edit/build//source/guides/helpers/forms.md" id="edit-guides-article" title="Edit this article" target="_blank">edit</a>
              <h2>Form Helpers</h2>

<p>It provides a powerful Ruby API to describe HTML5 forms, to be used both with views and templates. It ships with:</p>

<ul>
<li>Support for complex markup without the need of concatenation</li>
<li>Auto closing HTML5 tags</li>
<li>Support for view local variables</li>
<li>Method override support (<code>PUT</code>/<code>PATCH</code>/<code>DELETE</code> HTTP verbs aren&rsquo;t understood by browsers)</li>
<li>Automatic generation of HTML attributes for inputs: <code>id</code>, <code>name</code>, <code>value</code></li>
<li>Allow to override automatic HTML attributes</li>
<li>Read values from request params and/or given entities, to autofill <code>value</code> attributes</li>
<li>Automatic selection of current value for radio button and select inputs</li>
<li>CSRF Protection</li>
<li>Infinite nested fields</li>
<li>ORM Agnostic</li>
</ul>

<h2>Technical notes</h2>

<h3>Zero monkey-patching</h3>

<p>This feature has a similar syntax to other Ruby gems with the same purpose, but it has a different usage if compared with Rails or Padrino.</p>

<p>Those frameworks allow a syntax like this:</p>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span> <span class="n">form_for</span> <span class="ss">:book</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">f</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>

<p>The code above <strong>isn&rsquo;t a valid ERB template</strong>. To make it work, Rails uses monkey-patches ERB, and Padrino supports only HAML with that syntax.</p>

<p>One of the pillars of Lotus is <em>&ldquo;zero monkey-patch of Ruby core and stdlib&rdquo;</em>. We want to keep this principle for this feature too.</p>

<h3>Template engine independent</h3>

<p>Avoiding monkey-patching has a big advantage: <strong>form helpers are designed to be independent from the template engine</strong>. That means we can use Slim, HAML, or ERB and keep the same Ruby syntax.</p>

<h3>One output block</h3>

<p>The technical compromise for the principles described above is to use the form builder in an unique output block.</p>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span>
  <span class="n">form_for</span> <span class="ss">:book</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">books_path</span> <span class="k">do</span>
    <span class="n">text_field</span> <span class="ss">:title</span>

    <span class="n">submit</span> <span class="s1">'Create'</span>
  <span class="k">end</span>
<span class="cp">%&gt;</span>
</code></pre>

<p>This will produce</p>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/books"</span> <span class="na">id=</span><span class="s">"book-form"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"0a800d6a8fc3c24e7eca319186beb287689a91c2a719f1cbb411f721cacd79d4"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[title]"</span> <span class="na">id=</span><span class="s">"book-id"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Create<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<h3>Method in views</h3>

<p>An <strong>alternative usage</strong> is to define a concrete method in a view and to use it in the template:</p>
<pre class="language-ruby ruby"><code><span class="k">module</span> <span class="nn">Web::Views::Books</span>
  <span class="k">class</span> <span class="nc">New</span>
    <span class="kp">include</span> <span class="no">Web</span><span class="o">::</span><span class="no">View</span>

    <span class="k">def</span> <span class="nf">form</span>
      <span class="n">form_for</span> <span class="ss">:book</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">books_path</span> <span class="k">do</span>
        <span class="n">text_field</span> <span class="ss">:title</span>

        <span class="n">submit</span> <span class="s1">'Create'</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span> <span class="n">form</span> <span class="cp">%&gt;</span>
</code></pre>

<h3>Supported methods</h3>

<ul>
<li>color_field</li>
<li>date_field</li>
<li>datetime_field</li>
<li>datetime<em>local</em>field</li>
<li>email_field</li>
<li>hidden_field</li>
<li>file_field</li>
<li>fields_for</li>
<li>form_for</li>
<li>label</li>
<li>text_area</li>
<li>text_field</li>
<li>password_field</li>
<li>radio_button</li>
<li>select</li>
<li>submit</li>
</ul>

<h2>Examples</h2>

<h3>Basic usage</h3>

<p>The API is really clean and concise, <strong>it doesn&rsquo;t require concatenation</strong> between the returning value of the block (<code>submit</code>) and the previous lines (<code>div</code>).</p>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span>
  <span class="n">form_for</span> <span class="ss">:book</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">books_path</span><span class="p">,</span> <span class="ss">class: </span><span class="s1">'form-horizontal'</span> <span class="k">do</span>
    <span class="n">div</span> <span class="k">do</span>
      <span class="n">label</span>      <span class="ss">:title</span>
      <span class="n">text_field</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">class: </span><span class="s1">'form-control'</span>
    <span class="k">end</span>

    <span class="n">submit</span> <span class="s1">'Create'</span>
  <span class="k">end</span>
<span class="cp">%&gt;</span>
</code></pre>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/books"</span> <span class="na">id=</span><span class="s">"book-form"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">class=</span><span class="s">"form-horizontal"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"1825a0a7ea92bbe3fd60cc8b6a0ea00ce3c52030afbf4037370d937bc5248acb"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"book-title"</span><span class="nt">&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[title]"</span> <span class="na">id=</span><span class="s">"book-title"</span> <span class="na">value=</span><span class="s">"Test Driven Development"</span> <span class="na">class=</span><span class="s">"form-control"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Create<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<h3>Method override</h3>

<p>Browsers don&rsquo;t understand HTTP methods outside of <code>GET</code> and <code>POST</code>. On the other hand, Lotus embraces REST conventions, that goes beyond that two verbs. When we specify a method via <code>:method</code>, it adds a special hidden field <code>_method</code>, that&rsquo;s understood by the application.</p>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span>
  <span class="n">form_for</span> <span class="ss">:book</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">book_path</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="nf">id</span><span class="p">),</span> <span class="ss">method: :put</span> <span class="k">do</span>
    <span class="n">text_field</span> <span class="ss">:title</span>

    <span class="n">submit</span> <span class="s1">'Update'</span>
  <span class="k">end</span>
<span class="cp">%&gt;</span>
</code></pre>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/books/23"</span> <span class="na">id=</span><span class="s">"book-form"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"PUT"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"5f1029dd15981648a0882ec52028208410afeaeffbca8f88975ef199e2988ce7"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[title]"</span> <span class="na">id=</span><span class="s">"book-title"</span> <span class="na">value=</span><span class="s">"Test Driven Development"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<h3>CSRF Protection</h3>

<p>Cross Site Request Forgery (CSRF) is one of the most common attacks on the web. Lotus offers a security mechanism based on a technique called: <em>Synchronizer Token Pattern</em>.</p>

<p>When we enable sessions, it uses them to store a random token for each user.
Forms are rendered with a special hidden field (<code>_csrf_token</code>) which contains this token.</p>

<p>On form submission, Lotus matches this input with the value from the session. If they match, the request can continue. If not, it resets the sesssion and raises an exception.</p>

<p>Developers can customize attack handling.</p>

<h3>Nested fields</h3>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span>
  <span class="n">form_for</span> <span class="ss">:delivery</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">deliveries_path</span> <span class="k">do</span>
    <span class="n">text_field</span> <span class="ss">:customer_name</span>

    <span class="n">fields_for</span> <span class="ss">:address</span> <span class="k">do</span>
      <span class="n">text_field</span> <span class="ss">:city</span>
    <span class="k">end</span>

    <span class="n">submit</span> <span class="s1">'Create'</span>
  <span class="k">end</span>
<span class="cp">%&gt;</span>
</code></pre>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/deliveries"</span> <span class="na">id=</span><span class="s">"delivery-form"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"4800d585b3a802682ae92cb72eed1cdd2894da106fb4e9e25f8a262b862c52ce"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[customer_name]"</span> <span class="na">id=</span><span class="s">"delivery-customer-name"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[address][city]"</span> <span class="na">id=</span><span class="s">"delivery-address-city"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Create<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<h2>Automatic values</h2>

<p>Form fields are <strong>automatically filled with the right value</strong>. Lotus looks up for explicit values passed in the form constructor and for the params of the current request. It compares the form hierarchy (including nested fields), with these two sources. For each match, it fills the associated value.</p>

<h4>Example</h4>

<p>Imagine we want to update data for <code>delivery</code>. We have two objects: <code>delivery</code> and <code>customer</code>, which are plain objects (no ORM involved). They respond to the following methods:</p>
<pre class="language-ruby ruby"><code><span class="n">delivery</span><span class="p">.</span><span class="nf">id</span>   <span class="c1"># =&gt; 1</span>
<span class="n">delivery</span><span class="p">.</span><span class="nf">code</span> <span class="c1"># =&gt; 123</span>

<span class="n">customer</span><span class="p">.</span><span class="nf">name</span> <span class="c1"># =&gt; "Luca"</span>

<span class="n">customer</span><span class="p">.</span><span class="nf">address</span><span class="p">.</span><span class="nf">class</span> <span class="c1"># =&gt; Address</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">address</span><span class="p">.</span><span class="nf">city</span>  <span class="c1"># =&gt; "Rome"</span>
</code></pre>

<p>Let&rsquo;s compose the form.</p>
<pre class="language-ruby erb"><code><span class="cp">&lt;%=</span>
  <span class="n">form_for</span> <span class="ss">:delivery</span><span class="p">,</span> <span class="n">routes</span><span class="p">.</span><span class="nf">delivery_path</span><span class="p">(</span><span class="ss">id: </span><span class="n">delivery</span><span class="p">.</span><span class="nf">id</span><span class="p">),</span> <span class="ss">method: :patch</span><span class="p">,</span> <span class="ss">values: </span><span class="p">{</span><span class="ss">delivery: </span><span class="n">delivery</span><span class="p">,</span> <span class="ss">customer: </span><span class="n">customer</span><span class="p">}</span> <span class="k">do</span>
    <span class="n">text_field</span> <span class="ss">:code</span>

    <span class="n">fields_for</span> <span class="ss">:customer</span> <span class="k">do</span>
      <span class="n">text_field</span> <span class="ss">:name</span>

      <span class="n">fields_for</span> <span class="ss">:address</span> <span class="k">do</span>
        <span class="n">text_field</span> <span class="ss">:city</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">submit</span> <span class="s1">'Update'</span>
  <span class="k">end</span>
<span class="cp">%&gt;</span>
</code></pre>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/deliveries/1"</span> <span class="na">id=</span><span class="s">"delivery-form"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"PATCH"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"4800d585b3a802682ae92cb72eed1cdd2894da106fb4e9e25f8a262b862c52ce"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[code]"</span> <span class="na">id=</span><span class="s">"delivery-code"</span> <span class="na">value=</span><span class="s">"123"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[customer][name]"</span> <span class="na">id=</span><span class="s">"delivery-customer-name"</span> <span class="na">value=</span><span class="s">"Luca"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[customer][address][city]"</span> <span class="na">id=</span><span class="s">"delivery-customer-address-city"</span> <span class="na">value=</span><span class="s">"Rome"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

<p>Please note the <code>:values</code> option that we pass to <code>#form_for</code>. It maps the <code>name</code> attributes that we have in the form with the objects that we want to use to fill the values. For instance <code>delivery[code]</code> corresponds to <code>delivery.code</code> (<code>123</code>), <code>delivery[customer][address][city]</code> to <code>customer.address.city</code> (<code>&quot;Rome&quot;</code>) and so on..</p>

<h3>Read Values From Params</h3>

<p><strong>Params are automatically passed to form helpers</strong>, to read values and try to autofill fields. If a value is present both in params and explicit values (<code>:values</code>), the first takes precendence. The reason is simple: params sometimes represent a failed form submission attempt.</p>

<h4>Example</h4>

<p>Imagine the form described above, and that our user enters <code>&quot;foo&quot;</code> as delivery code. This value isn&rsquo;t acceptable for our model domain rules, so we render again the form, presenting a validation error. Our params are now carrying on the values filled by our user. For instance: <code>params.get(&#39;delivery.code&#39;)</code> returns <code>&quot;foo&quot;</code>.</p>

<p>Here how the form is rendered:</p>
<pre class="language-ruby html"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/deliveries/1"</span> <span class="na">id=</span><span class="s">"delivery-form"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"PATCH"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_csrf_token"</span> <span class="na">value=</span><span class="s">"4800d585b3a802682ae92cb72eed1cdd2894da106fb4e9e25f8a262b862c52ce"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[code]"</span> <span class="na">id=</span><span class="s">"delivery-code"</span> <span class="na">value=</span><span class="s">"foo"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[customer][name]"</span> <span class="na">id=</span><span class="s">"delivery-customer-name"</span> <span class="na">value=</span><span class="s">"Luca"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"delivery[customer][address][city]"</span> <span class="na">id=</span><span class="s">"delivery-customer-address-city"</span> <span class="na">value=</span><span class="s">"Rome"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>

            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="email-signup">
  <div class="container-fluid wrapper">
    <form action="http://lotusrb.us3.list-manage.com/subscribe/post" method="POST" class="">
      <input name="u" value="dcbeefa4ba1ea9ae043857005" type="hidden">
      <input name="id" value="fb3873a90f" type="hidden">
      <input name="orig-lang" value="1" type="hidden">
      <input type="email" placeholder="Enter your email to get updates" spellcheck="false" autocapitalize="off" autocorrect="off" name="MERGE0" id="MERGE0" value="" class="pull-left">
      <button type="submit" class="btn btn-primary pull-right">Subscribe</button>
    </form>
  </div>
</section>

<footer class="primary">
  <div class="container-fluid wrapper">
    <div class="row">
      <a class="logo col-md-3" href="/">logo</a>
        <div class="col-md-4">
          <span class="date">September 30, 2015</span>
          <h4>Announcing Lotus v0.5.0</h4>
          <p>Features: Mailers, custom data mapper coercions, command / query separation. Rails Girls Summer of Code and Hack Day!
</p>
          <a href="/blog/2015/09/30/announcing-lotus-050.html">Read more...</a>
        </div>
        <div class="col-md-4">
          <span class="date">July 12, 2015</span>
          <h4>Weekly Changelog</h4>
          <p>Changelog from Jun 29 2015 to Jul 12 2015
</p>
          <a href="/blog/2015/07/12/weekly-changelog.html">Read more...</a>
        </div>
    </div>
  </div>

  <div class="sub-footer wrapper">
    <p class="copyright pull-left">&copy; 2014-<span id="copyright-year">{{year}}</span> <a href="http://lucaguidi.com/">Luca Guidi</a> – Lotus is released under the MIT License.
    <br>
    <br> This website and its contents are released under <a href="http://creativecommons.org/licenses/by-nc/4.0/" href="_blank">CC Attribution-NonCommercial 4.0</a>.
    <br> Maintained with <3 by the <a href="https://github.com/orgs/lotus/people" target="_blank">core team</a> with help from <a href="https://github.com/lotus/lotus/graphs/contributors" target="_blank">contributors</a>. Site Design by <a href="http://www.alantippins.com/">Alan Tippins</a>.</p>
    <ul class="social">
      <li><a href="https://twitter.com/lotus_rb" target="_blank" class="icon-twitter"></a></li>
      <li><a href="https://github.com/lotus" target="_blank" class="icon-github"></a></li>
    </ul>
  </div>

  <div id="sponsors" class="sub-footer wrapper row">
    <div class="col-xs-6 col-md-4">
      <a href="http://dnsimple.link/resolving-lotus" target="_blank">
        <span>Resolving with<br/></span>
        <img src="https://cdn.dnsimple.com/assets/resolving-with-us/logo-dark.png" alt="DNSimple" style="display:block;margin:0;padding:0;width:100px;"/>
      </a>
    </div>
    <div class="col-xs-6 col-md-8">
    </div>
  </div>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="javascripts/vendor/jquery-1.11.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>

<script src="/javascripts/application.js" type="text/javascript"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47369640-1', 'lotusrb.org');
  ga('send', 'pageview');
</script>

  </body>
</html>
